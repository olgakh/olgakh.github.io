!function t(e,i,n){function o(s,a){if(!i[s]){if(!e[s]){var d="function"==typeof require&&require;if(!a&&d)return d(s,!0);if(r)return r(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=i[s]={exports:{}};e[s][0].call(l.exports,function(t){var i=e[s][1][t];return o(i?i:t)},l,l.exports,t,e,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(t,e,i){function n(){for(var t=p+"=",e=document.cookie.split(";"),i=0;i<e.length;i++){for(var n=e[i];" "===n.charAt(0);)n=n.substring(1);if(0===n.indexOf(t))return n.substring(t.length,n.length)}}function o(t){var e=r(),i=30,n="path=/",o="domain="+e,s="expires="+new Date((new Date).getTime()+6e4*i);document.cookie=[p+"="+t,n,o,s].join("; ")}function r(){for(var t="weird_get_top_level_domain=cookie",e=document.location.hostname.split("."),i=e.length-1;i>=0;i--){var n=e.slice(i).join(".");if(document.cookie=t+";domain=."+n+";",document.cookie.indexOf(t)>-1)return document.cookie=t.split("=")[0]+"=;domain=."+n+";expires=Thu, 01 Jan 1970 00:00:01 GMT;",n}}function s(t){var e;try{e=n();var i=JSON.parse(decodeURIComponent(e));if(i.businessUnitId===t)return i}catch(o){if(e){var r="domain="+window.location.hostname.replace(/^.*\.([^.]+\.[^.]+)/,"$1");document.cookie=p+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/;"+r}}}function a(t){t&&o(encodeURIComponent(JSON.stringify(t)))}function d(t,e){var i=s(t);return i?void e(i):void c.xhrGet({url:h+"//widget.trustpilot.com/v1/ratios/"+t,success:function(i){var n=g(i,t);a(n),e(n)},error:function(){e(null)}})}function u(t,e){for(e=t="";t++<36;e+=51*t&52?(15^t?8^Math.random()*(20^t?16:4):4).toString(16):"-");return e}var l=t("./constants.js").OFF,c=t("./xhr.js"),h="https:"==document.location.protocol?"https:":"http:",p="TrustboxSplitTest",g=function(t,e){if(!t||!t.groups)return null;for(var i=0,n=0,o=[],r=0;r<t.groups.length;r++)"number"==typeof t.groups[r].ratio&&(i+=t.groups[r].ratio,++n,o.push(t.groups[r]));if(0===n)return null;1===n&&i<1&&(o.push({name:l,ratio:1-i}),i=1);var s=0,a=Math.random()*i,d=o[0].name,c=[];for(r=0;r<o.length;r++)a>=s&&a<s+o[r].ratio&&(d=o[r].name),c.push(o[r].name),s+=o[r].ratio;return{allGroups:c,group:d,businessUnitId:e,session:u(),anonymousId:u()}};e.exports={getABSettingsAsync:d}},{"./constants.js":3,"./xhr.js":7}],2:[function(t,e,i){function n(t,e,i,n){var r={element:t,type:e,options:n};if(r.removeEventListener=function(){o(this.element,this.type,this.listener,this.options)},t.addEventListener)t.addEventListener(e,i,n),r.listener=i;else if(t.attachEvent){var s=function(t){t=t||window.event,t.preventDefault=t.preventDefault||function(){t.returnValue=!1},t.stopPropagation=t.stopPropagation||function(){t.cancelBubble=!0},i.call(void 0,t)};t.attachEvent("on"+e,s),r.listener=s}return r}var o=function(t,e,i,n){t.removeEventListener?t.removeEventListener(e,i,n):t.removeEventListener&&t.detachEvent("on"+e,i)};e.exports=n},{}],3:[function(t,e,i){e.exports={EMPTY_WIDGET_ID:"000000000000000000000000",OFF:"OFF"}},{}],4:[function(t,e,i){function n(t){if(!s){var e=document.createElement("script");e.setAttribute("type","application/ld+json"),e.innerHTML=JSON.stringify(t),document.head.appendChild(document.createComment("Added by Trustpilot")),document.head.appendChild(e),document.head.appendChild(document.createComment("/Added by Trustpilot")),s=!0}}function o(t,e,i,n,o){var r=d+"//widget.trustpilot.com/data/jsonld/business-unit/"+e+"?type="+t+"&url="+encodeURIComponent(window.location.origin+window.location.pathname)+"&templateId="+n+"&locale="+i;a.xhrGet({url:r,success:function(t){t.url=document.location.href,o(t)},error:function(t){console.error(t)}})}function r(t,e,i,n,o,r,s){var u=e&&e.split("-")[0],l="5763ba71ba484803e8b222ba"===i||"5763bccae0a06d08e809ecbb"===i,c="/data/jsonld/business-unit/"+t+"/product",h="/data/jsonld/business-unit/"+t+"/product-imported",p=l?h:c,g=d+"//widget.trustpilot.com"+p+"?sku="+encodeURIComponent(o)+"&numberOfReviews="+(r||10)+"&productName="+n+"&language="+u+"&templateId="+i+"&url="+encodeURIComponent(window.location.origin+window.location.pathname);a.xhrGet({url:g,success:s,error:function(t){console.error(t)}})}var s=!1,a=t("./xhr.js"),d="https:"==document.location.protocol?"https:":"http:",u=function(t){s||(t.schemaType?o(t.schemaType,t.businessunitId,t.locale,t.templateId,n):t.name&&t.sku&&r(t.businessunitId,t.locale,t.templateId,t.name,t.sku,t.reviewnumber,n))};e.exports=u},{"./xhr.js":7}],5:[function(t,e,i){function n(t,e,i,n){this.window=t,this.document=e,this.ABSettings=n,this.Widget=i,this.loading=!0}function o(t){if(t.getElementsByClassName)return t.getElementsByClassName("trustpilot-widget");if(t.querySelectorAll)return t.querySelectorAll(".trustpilot-widget");for(var e=[],i=new RegExp("(^| )trustpilot-widget( |$)"),n=t.body.getElementsByTagName("*"),o=0,r=n.length;o<r;o++)i.test(n[o].className)&&e.push(n[o]);return e}function r(t){for(var e=o(t),i=[],n=0;n<e.length;n++)i.push(s(e[n]));return{elements:e,datasets:i}}function s(t){if("undefined"!=typeof t.dataset)return t.dataset;if(t.attributes){for(var e=function(t){return t.replace(/(\-[a-z])/g,function(t){return t.toUpperCase().replace("-","")})},i={},n=0;n<t.attributes.length;n++){var o=t.attributes[n],r=o.name.match(/^data-(.+)$/i);if(r){var s=e(r[1]);i[s]=o.value}}return i}}function a(t,e,i){var n;return function(){var o=arguments,r=function(){n=null,t.apply(i,o)};clearTimeout(n),n=setTimeout(r,e)}}var d=t("./constants.js"),u=t("./addeventlistener.js"),l=d.OFF,c=d.EMPTY_WIDGET_ID;n.prototype.initializeOnPageLoad=function(){var t=this.window;if(this.loading){var e=5;"complete"!==this.document.readyState?t.setTimeout(function(){t.Trustpilot.Modules.WidgetManagement.initializeOnPageLoad()},e):t.Trustpilot.Modules.WidgetManagement.findAndApplyWidgets()}},n.prototype.findAndApplyWidgets=function(){this.loading=!0;var t=r(this.document),e=t.elements,i=t.datasets,n=null;if(!e||e.length<1)return void(this.loading=!1);for(var o=0;o<i.length;o++)if("group"in i[o]){n=i[o].businessunitId;break}if(n){var s=this;this.ABSettings.getABSettingsAsync(n,function(t){var n=s.applyWidgets(e,i,t);s.setupViewTracking(n)})}else{var a=this.applyWidgets(e,i);this.setupViewTracking(a)}},n.prototype.applyWidgets=function(t,e,i){for(var n=i&&i.session,o=i&&i.anonymousId,r=[],s=0;s<t.length;s++)this.checkWidgetDisplayAndUpdateDataset(i,e[s])&&r.push(new this.Widget(t[s],e[s],n,o));return this.loading=!1,r},n.prototype.checkWidgetDisplayAndUpdateDataset=function(t,e){return!(t&&"group"in e)||t.allGroups.indexOf(e.group)<0||(t.group==e.group||t.group==l&&(e.templateId=c,e.styleHeight=0,e.group=l,!0))},n.prototype.removeWidgets=function(){for(var t=o(this.document),e=0;e<t.length;++e)for(;t[e].firstChild;)t[e].removeChild(t[e].firstChild)},n.prototype.setupViewTracking=function(t){this.widgets=t;var e=a(function(){for(var t=0;t<this.widgets.length;t++){var e=this.widgets[t],i=e.id===c,r=i;i||(r=e.trackVisibility()),r&&this.widgets.splice(t,1)}0===this.widgets.length&&(n.removeEventListener(),o.removeEventListener())},100,this),i={passive:!0,capture:!1},n=u(window,"scroll",e,i),o=u(window,"resize",e,i);e()},e.exports=n},{"./addeventlistener.js":2,"./constants.js":3}],6:[function(t,e,i){function n(){var t=Math.random();return n[t]?n():(n[t]=!0,t)}function o(t){t=t.toLowerCase();var e=/(px|\%)/i,i="";return t&&t.length>0&&(i=e.test(t)?t:t+"px"),i}function r(e,i,r,s){if(!e)throw"No container supplied for TrustBox";if(!i)throw"No dataset supplied for TrustBox";if(!i.templateId)throw"No templateId supplied for TrustBox";if(!i.businessunitId)throw"No businessunitId supplied for TrustBox";if(!i.locale)throw"No locale supplied for TrustBox";var a=t("./snippets.js");a(i),this.id=n(),this.session=r,this.group=i.group,this.anonymousId=s,this.container=e,this.iframes={},this.baseUrl=c+"/"+i.templateId+"/",this.queryString=this.createQueryStringFromDataSet(i),this.hasSentImpression=!1,this.container.style.position="relative",this.options={source:d,frameBorder:0,allowTransparency:"true",scrolling:"no",styles:{borderStyle:"none",backgroundColor:"transparent",display:"block",overflow:"hidden",height:o(i.styleHeight),width:o(i.styleWidth),position:"relative"},show:!0},this.createIFrame("main",this.options);var u=this;h(window,"message",function(t){if(t.origin===l&&"string"==typeof t.data){var e;try{e=JSON.parse(t.data)}catch(i){return void console.log("Invalid data sent on widget: "+t.data)}if(e.widgetId===u.id){var n={data:e,origin:t.origin};u.widgetIframeMessageHandler(n)}}},!1)}function s(t,e,i,n){var o=e?e:{};return o.position=t.styles.position||"",o.zindex=t.styles.zindex||"",o.margin=t.styles.margin||"",o.top=t.styles.top||"",o.bottom=t.styles.bottom||"",o.left=t.styles.left||"",o.right=t.styles.right||"",o.height=t.styles.height||"",o.width=t.styles.width||e.styles.width||"",o.display=t.show?"block":"none",o.src=i+t.source+n,o.borderStyle=e.styles.borderStyle,o.overflow=e.styles.overflow,o}function a(t){var e=document.createElement("iframe");return e.style.position=t.position,e.style.zIndex=t.zindex,e.style.margin=t.margin,e.style.top=t.top,e.style.bottom=t.bottom,e.style.left=t.left,e.style.right=t.right,e.style.height=t.height,e.style.width=t.width,e.style.borderStyle=t.borderStyle,e.style.backgroundColor=t.backgroundColor,e.style.display=t.display,e.style.overflow=t.overflow,e.frameBorder=t.frameBorder,e.scrolling=t.scrolling,e.allowTransparency=t.allowTransparency,e.src=t.src,e}var d="index.html",u="https:"==document.location.protocol?"https:":"http:",l=u+"//widget.trustpilot.com",c=u+"//widget.trustpilot.com/trustboxes",h=t("./addeventlistener.js");r.prototype={widgetIframeMessageHandler:function(t){switch(t.data.command){case"createIFrame":this.createIFrame(t.data.name,t.data);break;case"setStyle":this.setStyle(t.data.name,t.data.style);break;case"loaded":this.sendLoadedToMainFrame();break;case"message":this.sendMessage(this.iframes[t.data.name],t.data);break;case"resize-height":this.resizeHeight(t.data.name,t.data.height);break;case"impression":if(this.hasSentImpression)return;this.hasSentImpression=!0;var e=this.getTrackingData("impression-received");this.sendMessage(this.iframes.main,e),this.trackVisibility();break;case"product-review-data":}},getTrackingData:function(t){var e={command:t,url:window.document.URL,referrer:window.document.referrer,userAgent:window.navigator.userAgent,language:window.navigator.userLanguage||window.navigator.language,platform:window.navigator.platform};return this.session&&this.group&&(e.session=this.session),this.anonymousId&&(e.anonymousId=this.anonymousId),e},createQueryStringFromDataSet:function(t){var e="?";for(var i in t)e+=i+"="+encodeURIComponent(t[i])+"&";return e.replace(/(\&|\?)+$/,"")},createIFrame:function(t,e){var i=a(s(e,this.options,this.baseUrl,this.queryString)),n=this;this.iframes[t]=i,this.container.appendChild(i),h(i,"load",function(){n.setWidgetId(i)})},setStyle:function(t,e){var i=this.iframes[t]||this.iframes.main;for(var n in e)i.style[n]=e[n]},sendLoadedToMainFrame:function(){this.sendMessage(this.iframes.main,"loaded")},resizeHeight:function(t,e){if("number"==typeof e){var i=this.iframes[t]||this.iframes.main;i&&(i.style.height=e+"px")}},sendMessage:function(t,e){e=JSON.stringify(e),t.contentWindow.postMessage(e,l)},setWidgetId:function(t){this.sendMessage(t,{command:"setId",widgetId:this.id})},sendVisibilityData:function(){if(!this.hasSentViewTracking){this.hasSentViewTracking=!0;var t=this.getTrackingData("trustbox-in-viewport");this.sendMessage(this.iframes.main,t)}},trackVisibility:function(){if(this.hasSentViewTracking)return!0;if(this.hasBeenVisible)return this.hasSentImpression&&this.sendVisibilityData(),!0;var t=.5,e=this.isInViewport(t);return!!e&&(this.hasSentImpression?(this.sendVisibilityData(),!0):(this.hasBeenVisible=!0,!0))},isInViewport:function(t){var e=this.iframes.main.getBoundingClientRect(),i={width:e.width||this.iframes.main.offsetWidth,height:e.height||this.iframes.main.offsetHeight};return e.top>=0&&e.left>=0&&e.bottom-i.height*t<=(window.innerHeight||document.documentElement.clientHeight)&&e.right-i.width*t<=(window.innerWidth||document.documentElement.clientWidth)}},e.exports=r},{"./addeventlistener.js":2,"./snippets.js":4}],7:[function(t,e,i){function n(t){try{return JSON.parse(t.responseText)}catch(e){return t.responseText}}function o(t){var e=new window.XMLHttpRequest;e.open("GET",t.url,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.onreadystatechange=function(){4===e.readyState&&(e.status>=200&&e.status<300?t.success(n(e)):t.error&&t.error(n(e)))},e.send()}e.exports={xhrGet:o}},{}],8:[function(t,e,i){!function(){"use strict";try{!function(){var e=t("./lib/widget.js"),i=t("./lib/ab-settings.js"),n=t("./lib/widget-management.js");window.Trustpilot=window.Trustpilot||{},window.Trustpilot.Modules=window.Trustpilot.Modules||{},window.Trustpilot.Modules.WidgetManagement=window.Trustpilot.Modules.WidgetManagement||new n(window,document,e,i),window.Trustpilot.Modules.WidgetManagement.loading=!0,window.Trustpilot.Modules.WidgetManagement.initializeOnPageLoad()}()}catch(e){!function(){function t(t){console.error("Error on bootstrap:"+t);var e="//widget.trustpilot.com/feedback/report-error",i="error="+encodeURIComponent(t)+"&uri="+encodeURIComponent(document.URL),n=document.createElement("img");n.src=e+"?"+i}try{t("object"==typeof e?e.message:e)}catch(e){console.error("Error on error reporting method:"+e)}}()}}()},{"./lib/ab-settings.js":1,"./lib/widget-management.js":5,"./lib/widget.js":6}]},{},[8]);
//# sourceMappingURL=tp.widget.bootstrap.min.js.map
